# 死代码清理计划

## 当前状态

移除全局 `#![allow(dead_code)]` 后，暴露出 41 个警告。

## 警告分类

### 1. API 预留字段（建议保留并标记）
- 各类 `Request`/`Response` 结构体的字段
- 配置结构体的字段
- 公开 API 的方法

处理方式：添加 `#[allow(dead_code)]` + 文档注释

### 2. 待实现功能（建议保留）
- `execute_skill` 等方法
- Matrix 联邦相关代码

处理方式：添加 `#[allow(dead_code)]` + TODO 注释

### 3. 真正的死代码（建议删除）
- 未使用的常量
- 未使用的内部函数
- 重复的实现

处理方式：直接删除

## 批量修复命令

```bash
# 查找所有死代码警告
cargo check --package cis-core 2>&1 | grep "warning:.*is never"

# 统计数量
cargo check --package cis-core 2>&1 | grep -c "warning:"
```

## 文件级别允许（临时方案）

对于包含大量 API 预留字段的文件，可以在文件顶部添加：

```rust
#![allow(dead_code)]  // API 预留，将来使用
```

## 逐步修复清单

- [ ] agent/cluster/session.rs - 默认终端大小常量
- [ ] matrix/events/dag.rs - 提案事件结构体
- [ ] network/websocket/*.rs - 连接相关结构体
- [ ] skill/router.rs - 路由方法
- [ ] storage/*.rs - 存储层方法

## 长期目标

- 死代码警告 < 10 个
- 所有保留的死代码都有文档说明
- 真正的死代码全部删除
