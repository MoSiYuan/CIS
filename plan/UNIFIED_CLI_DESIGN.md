# CIS Smart CLI è®¾è®¡æ–‡æ¡£

## é—®é¢˜èƒŒæ™¯

### å‘½ä»¤ç¢ç‰‡åŒ–é—®é¢˜

å½“å‰ CIS CLI å­˜åœ¨ä¸¥é‡çš„å‘½ä»¤ç¢ç‰‡åŒ–é—®é¢˜ï¼š

```bash
# åˆå§‹åŒ–ç›¸å…³
cis init --non-interactive --provider claude
cis init --project

# ç½‘ç»œç›¸å…³ï¼ˆåˆ†æ•£åœ¨å¤šä¸ªå­å‘½ä»¤ï¼‰
cis pair generate
cis pair join --address <ip> --code <code>
cis neighbor scan
cis neighbor list
cis node register
cis network trust <id>

# çŠ¶æ€ç›¸å…³
cis status
cis node status
cis network status

# é…ç½®ç›¸å…³ï¼ˆå¿…é¡»æ‰‹åŠ¨ç¼–è¾‘ TOMLï¼‰
vim ~/.cis/config.toml  # ç”¨æˆ·ç—›ç‚¹ï¼
```

### ç”¨æˆ·ç—›ç‚¹

1. **è®°å¿†è´Ÿæ‹…é‡**: 20+ ä¸ªåˆ†æ•£çš„å­å‘½ä»¤ï¼Œéš¾ä»¥è®°å¿†
2. **TOML é…ç½®åœ°ç‹±**: å¿…é¡»æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶
3. **Agent CLI å›°éš¾**: AI ä»£ç†éš¾ä»¥å‘ç°å’Œæ‰§è¡Œæ­£ç¡®çš„å‘½ä»¤
4. **ç¼ºä¹å¼•å¯¼**: æ–°ç”¨æˆ·ä¸çŸ¥é“ä»ä½•å¼€å§‹

## æ™ºèƒ½ CLI è®¾è®¡

### æ ¸å¿ƒå‘½ä»¤ç»“æ„

```
cis [command]
  â”œâ”€â”€ setup     â†’ ä¸€é”®åˆå§‹åŒ– CISï¼ˆæ›¿ä»£å¤æ‚çš„ init + é…ç½®ï¼‰
  â”œâ”€â”€ join      â†’ ä¸€é”®åŠ å…¥/åˆ›å»ºç½‘ç»œï¼ˆæ›¿ä»£ pair + neighborï¼‰
  â”œâ”€â”€ status    â†’ ç»Ÿä¸€çŠ¶æ€æŸ¥çœ‹ï¼ˆæ›¿ä»£å¤šä¸ª status å‘½ä»¤ï¼‰
  â””â”€â”€ do        â†’ æ™ºèƒ½æ‰§è¡Œè‡ªç„¶è¯­è¨€å‘½ä»¤
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# 1. å¿«é€Ÿåˆå§‹åŒ–ï¼ˆå…¨è‡ªåŠ¨ï¼‰
cis setup --auto --role worker

# 2. äº¤äº’å¼åˆå§‹åŒ–ï¼ˆæ¨èæ–°æ‰‹ï¼‰
cis setup
# ? é€‰æ‹©èŠ‚ç‚¹è§’è‰²: Coordinator / Worker / Edge
# ? é…ç½® AI æä¾›è€…: Claude / Kimi / OpenAI
# ? è®¾ç½®ç½‘ç»œå‘ç°: Auto / Manual

# 3. åŠ å…¥ç½‘ç»œï¼ˆè‡ªåŠ¨å‘ç°ï¼‰
cis join
# æ­£åœ¨æ‰«ææœ¬åœ°ç½‘ç»œ...
# å‘ç° 2 ä¸ª CIS èŠ‚ç‚¹:
#   [1] 192.168.1.100 - Coordinator
#   [2] 192.168.1.101 - Worker
# ? é€‰æ‹©è¦åŠ å…¥çš„èŠ‚ç‚¹ (æˆ–è¾“å…¥é…å¯¹ç ): 1
# âœ… å·²æˆåŠŸåŠ å…¥ç½‘ç»œ

# 4. ä½¿ç”¨é…å¯¹ç åŠ å…¥
cis join --code 123456

# 5. æŸ¥çœ‹ç»Ÿä¸€çŠ¶æ€
cis status
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ CIS Node Status                         â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ Node:   node-abc123 (Worker)            â”‚
# â”‚ DID:    did:cis:abc123:xyz789           â”‚
# â”‚ Uptime: 3 days 2 hours                  â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ Network: 3 peers connected              â”‚
# â”‚   â”œâ”€ coordinator (Trusted)              â”‚
# â”‚   â”œâ”€ worker-1 (Trusted)                 â”‚
# â”‚   â””â”€ worker-2 (Pending)                 â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ Performance: CPU 23% | Memory 45%       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# 6. è‡ªç„¶è¯­è¨€å‘½ä»¤ï¼ˆAgent å‹å¥½ï¼‰
cis do "initialize CIS as coordinator"
cis do "join the network using code 123456"
cis do "show me the current status"
```

## å®ç°çŠ¶æ€

### å·²å®ç° âœ…

| å‘½ä»¤ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| `cis setup` | âœ… | ä¸€é”®åˆå§‹åŒ–ï¼Œæ”¯æŒè‡ªåŠ¨å’Œäº¤äº’æ¨¡å¼ |
| `cis join` | âœ… | è‡ªåŠ¨å‘ç° + é…å¯¹ç åŠ å…¥ç½‘ç»œ |
| `cis status` | âœ… | ç»Ÿä¸€çŠ¶æ€é¢æ¿ |
| `cis do` | âœ… | è‡ªç„¶è¯­è¨€å‘½ä»¤è§£æ |

### å¾…å®ç° ğŸš§

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| åµŒå…¥å¼é…ç½®ç®¡ç† | é«˜ | ç¨‹åºåŒ–ä¿®æ”¹é…ç½®ï¼Œæ— éœ€ç¼–è¾‘ TOML |
| è‡ªåŠ¨ç½‘ç»œæ‹“æ‰‘æ£€æµ‹ | ä¸­ | è‡ªåŠ¨å‘ç° Coordinator/Worker è§’è‰² |
| æ™ºèƒ½è¯Šæ–­å’Œä¿®å¤ | ä¸­ | `cis doctor` è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜ |
| å¼•å¯¼å¼é¦–æ¬¡è®¾ç½® | ä¸­ | `cis wizard` åˆ†æ­¥å¼•å¯¼æ–°ç”¨æˆ· |

## æŠ€æœ¯å®ç°

### æ¨¡å—ç»“æ„

```
cis-node/src/commands/unified/
â”œâ”€â”€ mod.rs      # ç»Ÿä¸€å‘½ä»¤å…¥å£å’Œè·¯ç”±
â”œâ”€â”€ setup.rs    # åˆå§‹åŒ–é€»è¾‘
â”œâ”€â”€ join.rs     # ç½‘ç»œåŠ å…¥é€»è¾‘
â”œâ”€â”€ status.rs   # çŠ¶æ€æ”¶é›†å’Œå±•ç¤º
â””â”€â”€ README.md   # å¼€å‘æ–‡æ¡£
```

### é¡¶å±‚å‘½ä»¤é›†æˆ

åœ¨ `main.rs` ä¸­ï¼š

```rust
#[derive(Subcommand, Debug)]
enum Commands {
    // ... å…¶ä»–å‘½ä»¤
    
    /// ğŸš€ Quick setup CIS (smart interface)
    Setup {
        #[arg(long)]
        auto: bool,
        #[arg(long, value_enum, default_value = "worker")]
        role: NodeRole,
    },
    
    /// ğŸš€ Quick join network (smart interface)
    Join {
        #[arg(long, short)]
        address: Option<String>,
        #[arg(long, short)]
        code: Option<String>,
    },
    
    /// ğŸš€ Execute natural language command (smart interface)
    #[command(name = "do")]
    Do {
        command: Vec<String>,
    },
}
```

### å…³é”®ç‰¹æ€§

1. **åå‘å…¼å®¹**: åŸæœ‰å‘½ä»¤ç»§ç»­å·¥ä½œï¼Œæ–°å‘½ä»¤æ˜¯æ›´ä¾¿æ·çš„é€‰æ‹©
2. **ç»“æ„åŒ–è¾“å‡º**: æ”¯æŒ `--json` è¾“å‡ºï¼Œä¾¿äº Agent é›†æˆ
3. **æ™ºèƒ½é»˜è®¤**: åˆç†çš„é»˜è®¤å€¼ï¼Œå‡å°‘ç”¨æˆ·å†³ç­–
4. **æ¸è¿›å¼æŠ«éœ²**: åŸºç¡€ç”¨æ³•ç®€å•ï¼Œé«˜çº§åŠŸèƒ½å¯é€‰

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: é¦–æ¬¡å®‰è£… CIS

```bash
# ä¼ ç»Ÿæ–¹å¼ï¼ˆå¤æ‚ï¼‰
cis init --non-interactive --provider claude
# ç„¶åæ‰‹åŠ¨ç¼–è¾‘ ~/.cis/config.toml è®¾ç½®èŠ‚ç‚¹è§’è‰²
# ç„¶å cis pair generate ç”Ÿæˆé…å¯¹ç 
# ç„¶åæ‰‹åŠ¨é…ç½®ç½‘ç»œå‘ç°...

# æ™ºèƒ½ CLI æ–¹å¼ï¼ˆç®€å•ï¼‰
cis setup --auto --role coordinator
# âœ… å®Œæˆæ‰€æœ‰é…ç½®
```

### åœºæ™¯ 2: Agent è‡ªåŠ¨ç»„ç½‘

```bash
# Agent å¯ä»¥ç®€å•åœ°æ‰§è¡Œ:
cis setup --auto --role worker
cis join --auto

# æˆ–è€…è‡ªç„¶è¯­è¨€:
cis do "setup as worker and join the nearest network"
```

### åœºæ™¯ 3: å¿«é€ŸæŸ¥çœ‹çŠ¶æ€

```bash
# ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦å¤šä¸ªå‘½ä»¤
cis status
cis node status
cis neighbor list
cis network status

# æ™ºèƒ½ CLIï¼šä¸€ä¸ªå‘½ä»¤
cis status
```

## å‘åå…¼å®¹

åŸæœ‰çš„ `cis unified` å‘½ä»¤ä»ç„¶å¯ç”¨ï¼š

```bash
# è¿™ä¸¤ç§æ–¹å¼ç­‰ä»·
cis setup --auto
cis unified setup --auto

cis join --code 123456
cis unified join --code 123456
```

## å½“å‰çŠ¶æ€

- [x] è®¾è®¡é˜¶æ®µ - æ”¶é›†åé¦ˆ
- [x] å¼€å‘é˜¶æ®µ - å®ç°æ ¸å¿ƒåŠŸèƒ½ âœ… **å·²å®ç°**
- [ ] æµ‹è¯•é˜¶æ®µ - éªŒè¯å’Œä¼˜åŒ–
- [ ] å‘å¸ƒé˜¶æ®µ - æ–‡æ¡£å’Œè¿ç§»æŒ‡å—

### å·²å®ç°åŠŸèƒ½

```bash
# æŸ¥çœ‹å¸®åŠ©
cis --help
cis setup --help
cis join --help
cis do --help

# å¿«é€Ÿåˆå§‹åŒ– CIS
cis setup --auto --role worker
cis setup                    # äº¤äº’å¼åˆå§‹åŒ–

# åŠ å…¥ç½‘ç»œï¼ˆè‡ªåŠ¨å‘ç°æˆ–æŒ‡å®šåœ°å€ï¼‰
cis join
cis join --address 192.168.1.100 --code 123456

# æŸ¥çœ‹ç»Ÿä¸€çŠ¶æ€é¢æ¿
cis status
cis status --network --perf

# è‡ªç„¶è¯­è¨€å‘½ä»¤ï¼ˆæ™ºèƒ½è§£æï¼‰
cis do "åˆå§‹åŒ– CIS"
cis do "è¿æ¥ç½‘ç»œ"
cis do "æŸ¥çœ‹çŠ¶æ€"
```

## åç»­è§„åˆ’

### Phase 2: åµŒå…¥å¼é…ç½®ç®¡ç†

å®ç° `cis config` å­å‘½ä»¤ï¼š

```bash
# æŸ¥çœ‹é…ç½®
cis config list

# ä¿®æ”¹é…ç½®ï¼ˆæ— éœ€ç¼–è¾‘ TOMLï¼‰
cis config set node.role coordinator
cis config set ai.provider kimi
cis config set network.discovery auto

# éªŒè¯é…ç½®
cis config validate
```

### Phase 3: æ™ºèƒ½è¯Šæ–­

```bash
# è‡ªåŠ¨è¯Šæ–­å’Œä¿®å¤
cis doctor
# ? å‘ç° 3 ä¸ªé—®é¢˜:
#   [1] ç«¯å£ 7676 è¢«å ç”¨ â†’ ä¿®å¤? [Y/n]
#   [2] é…ç½®æ–‡ä»¶æƒé™é”™è¯¯ â†’ ä¿®å¤? [Y/n]
#   [3] èŠ‚ç‚¹ ID å†²çª â†’ ä¿®å¤? [Y/n]
```

### Phase 4: å‘å¯¼æ¨¡å¼

```bash
# äº¤äº’å¼å‘å¯¼
cis wizard
# æ­¥éª¤ 1: é€‰æ‹©èŠ‚ç‚¹è§’è‰²
# æ­¥éª¤ 2: é…ç½®ç½‘ç»œ
# æ­¥éª¤ 3: è®¾ç½® AI æä¾›è€…
# æ­¥éª¤ 4: å®Œæˆåˆå§‹åŒ–
```

## ç»“è®º

æ™ºèƒ½ CLI è§£å†³äº† CIS çš„å‘½ä»¤ç¢ç‰‡åŒ–é—®é¢˜ï¼Œæä¾›äº†ï¼š

1. **ç®€æ´å‘½ä»¤**: `cis setup`, `cis join`, `cis status`, `cis do`
2. **æ™ºèƒ½é»˜è®¤**: å‡å°‘ç”¨æˆ·å†³ç­–è´Ÿæ‹…
3. **è‡ªç„¶è¯­è¨€**: Agent å¯ä»¥ç›´æ¥ä½¿ç”¨
4. **æ¸è¿›å¼**: æ–°æ‰‹å‹å¥½ï¼ŒåŒæ—¶æ”¯æŒé«˜çº§ç”¨æˆ·

è¿™ä¸ªè®¾è®¡è®© CIS ä»ä¸€ä¸ªå¤æ‚çš„å·¥å…·é›†ï¼Œå˜æˆä¸€ä¸ªç®€å•æ˜“ç”¨çš„ç»Ÿä¸€ç³»ç»Ÿã€‚
