{
  "policy": "all_success",
  "tasks": [
    {
      "id": "fetch-diff",
      "name": "获取代码变更",
      "skill": "git-diff",
      "deps": [],
      "level": { "type": "mechanical", "retry": 3 },
      "retry": 3,
      "timeout_secs": 300,
      "rollback": [],
      "idempotent": false
    },
    {
      "id": "analyze",
      "name": "AI 分析",
      "skill": "ai-code-analyze",
      "deps": ["fetch-diff"],
      "level": { "type": "confirmed" },
      "retry": 3,
      "timeout_secs": 300,
      "rollback": [],
      "idempotent": false
    },
    {
      "id": "generate-report",
      "name": "生成报告",
      "skill": "report-generator",
      "deps": ["analyze"],
      "level": { "type": "mechanical", "retry": 3 },
      "retry": 3,
      "timeout_secs": 300,
      "rollback": ["rm -f report.md"],
      "idempotent": false
    }
  ]
}
