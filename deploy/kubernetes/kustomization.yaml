# CIS v1.1.0 Kubernetes Kustomization
# 使用 kustomize 管理部署

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: cis-deployment
  annotations:
    version: "1.1.0"
    description: "CIS Cluster of Independent Systems v1.1.0"

# 命名空间配置
namespace: default

# 资源列表
resources:
  - configmap.yaml
  - pvc.yaml
  - rbac.yaml
  - deployment.yaml
  - service.yaml

# 通用标签
commonLabels:
  app.kubernetes.io/name: cis
  app.kubernetes.io/version: "1.1.0"
  app.kubernetes.io/managed-by: kustomize

# 镜像配置（可通过 overlay 覆盖）
images:
  - name: cis
    newTag: v1.1.0

# ConfigMap 生成器（可选：从文件生成）
# configMapGenerator:
#   - name: cis-coordinator-config
#     files:
#       - configs/coordinator.toml

# 密钥生成器（可选：用于 TLS 证书）
# secretGenerator:
#   - name: cis-tls
#     files:
#       - certs/server.crt
#       - certs/server.key
#     type: kubernetes.io/tls

# 配置补丁（可通过 overlay 自定义）
# patchesStrategicMerge:
#   - patches/resource-limits.yaml
