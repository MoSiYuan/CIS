# CIS v1.1.4 任务分解与分配

> 创建日期: 2026-02-10  
> 更新日期: 2026-02-10  
> 基于: [SCOPE_FINAL.md](./SCOPE_FINAL.md)

---

## 团队配置

| 角色 | 人员 | 职责 |
|------|------|------|
| **开发 A** | TBD | 架构重构 + WASM + Agent 联邦 |
| **开发 B** | TBD | P2P 网络 + 调度器 + 安全加固 |
| **测试/安全** | TBD (50%) | 测试框架 + 安全基线 + 测试用例 |

---

## P0 任务分配

### P0-1: 架构重构 Phase 1-3 (开发 A, 20天)

| 子任务 | 设计文档 | 工期 | 开始 | 结束 | 依赖 |
|--------|---------|------|------|------|------|
| 1.1 配置抽象 - 结构定义 | [D01](./designs/D01_CONFIG_ABSTRACTION.md) | 2d | W1D1 | W1D2 | - |
| 1.2 配置抽象 - 加载器实现 | [D01](./designs/D01_CONFIG_ABSTRACTION.md) | 2d | W1D3 | W1D4 | 1.1 |
| 1.3 配置抽象 - 替换硬编码 | [D01](./designs/D01_CONFIG_ABSTRACTION.md) | 1d | W1D5 | W1D5 | 1.2 |
| 1.4 全局状态消除 - 接口定义 | [D02](./designs/D02_GLOBAL_STATE_ELIMINATION.md) | 2d | W2D1 | W2D2 | 1.3 |
| 1.5 全局状态消除 - 容器实现 | [D02](./designs/D02_GLOBAL_STATE_ELIMINATION.md) | 2d | W2D3 | W2D4 | 1.4 |
| 1.6 全局状态消除 - 服务改造 | [D02](./designs/D02_GLOBAL_STATE_ELIMINATION.md) | 3d | W2D5 | W3D2 | 1.5 |
| 1.7 事件总线 - 事件定义 | [D03](./designs/D03_EVENT_BUS.md) | 2d | W3D3 | W3D4 | 1.6 |
| 1.8 事件总线 - 总线实现 | [D03](./designs/D03_EVENT_BUS.md) | 2d | W3D5 | W4D1 | 1.7 |
| 1.9 事件总线 - 服务迁移 | [D03](./designs/D03_EVENT_BUS.md) | 3d | W4D2 | W4D4 | 1.8 |
| 1.10 架构重构验收 | - | 1d | W4D5 | W4D5 | 1.9 |

**里程碑 M1**: Week 4 结束，架构重构完成

---

### P0-2: 安全基线建立 (测试/安全, 5天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 2.1 威胁模型文档 | 2d | W1D1 | W1D2 | - |
| 2.2 攻击面分析 | 1d | W1D3 | W1D3 | 2.1 |
| 2.3 加固清单制定 | 2d | W1D4 | W1D5 | 2.2 |

**交付物**: [SECURITY_ASSESSMENT.md](./SECURITY_ASSESSMENT.md) 更新

---

### P0-3: WASM 基础执行 (开发 A, 10天)

| 子任务 | 设计文档 | 工期 | 开始 | 结束 | 依赖 |
|--------|---------|------|------|------|------|
| 3.1 WASM 运行时框架 | [D04](./designs/D04_WASM_EXECUTION.md) | 2d | W5D1 | W5D2 | M1 |
| 3.2 模块加载与验证 | [D04](./designs/D04_WASM_EXECUTION.md) | 2d | W5D3 | W5D4 | 3.1 |
| 3.3 Host 函数 - AI Provider | [D04](./designs/D04_WASM_EXECUTION.md) | 2d | W5D5 | W6D1 | 3.2 |
| 3.4 Host 函数 - Memory | [D04](./designs/D04_WASM_EXECUTION.md) | 1d | W6D2 | W6D2 | 3.3 |
| 3.5 Host 函数 - HTTP | [D04](./designs/D04_WASM_EXECUTION.md) | 1d | W6D3 | W6D3 | 3.4 |
| 3.6 Skill 集成 | [D04](./designs/D04_WASM_EXECUTION.md) | 2d | W6D4 | W6D5 | 3.5 |

**里程碑 M2**: Week 6 结束，WASM 可用

---

### P0-4: P2P 传输加密 (开发 B, 5天)

| 子任务 | 设计文档 | 工期 | 开始 | 结束 | 依赖 |
|--------|---------|------|------|------|------|
| 4.1 密钥管理实现 | [D05](./designs/D05_P2P_ENCRYPTION.md) | 1d | W5D1 | W5D1 | D01 |
| 4.2 Noise Protocol 集成 | [D05](./designs/D05_P2P_ENCRYPTION.md) | 2d | W5D2 | W5D3 | 4.1 |
| 4.3 安全传输层 | [D05](./designs/D05_P2P_ENCRYPTION.md) | 2d | W5D4 | W5D5 | 4.2 |

---

### P0-5: WASM 沙箱审计 (测试/安全, 3天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 5.1 资源限制测试 | 1d | W6D3 | W6D3 | P0-3 进行中 |
| 5.2 沙箱逃逸测试 | 1d | W6D4 | W6D4 | 5.1 |
| 5.3 安全报告 | 1d | W6D5 | W6D5 | 5.2 |

---

### P0-6: 测试框架搭建 (测试/安全, 5天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 6.1 Mock 框架实现 | 2d | W1D1 | W1D2 | - |
| 6.2 CI/CD 配置 | 2d | W1D3 | W1D4 | 6.1 |
| 6.3 覆盖率工具 | 1d | W1D5 | W1D5 | 6.2 |

---

## P1 任务分配

### P1-1: P2P 连接处理循环 (开发 B, 3天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 1.1 连接状态机设计 | 1d | W7D1 | W7D1 | P0-4 |
| 1.2 读写分离实现 | 1d | W7D2 | W7D2 | 1.1 |
| 1.3 连接管理 | 1d | W7D3 | W7D3 | 1.2 |

### P1-2: Agent 联邦事件订阅 (开发 A, 3天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 2.1 事件流接口 | 1d | W7D1 | W7D1 | M2 |
| 2.2 Matrix 事件订阅 | 1d | W7D2 | W7D2 | 2.1 |
| 2.3 事件过滤分发 | 1d | W7D3 | W7D3 | 2.2 |

### P1-3: 远程任务处理 (开发 A, 4天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 3.1 任务队列设计 | 1d | W7D4 | W7D4 | P1-2 |
| 3.2 任务接收处理器 | 1d | W7D5 | W7D5 | 3.1 |
| 3.3 结果返回机制 | 1d | W8D1 | W8D1 | 3.2 |
| 3.4 错误处理重试 | 1d | W8D2 | W8D2 | 3.3 |

**里程碑 M3**: Week 8 结束，核心功能完成

### P1-4: 输入验证框架 (开发 B, 2天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 4.1 验证接口定义 | 1d | W7D4 | W7D4 | - |
| 4.2 常见验证器实现 | 1d | W7D5 | W7D5 | 4.1 |

### P1-5: 命令白名单 (开发 B, 2天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 5.1 白名单配置 | 1d | W8D1 | W8D1 | P1-4 |
| 5.2 执行前检查 | 1d | W8D2 | W8D2 | 5.1 |

### P1-6: 测试用例编写 (测试/安全, 15天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 6.1 P2P 模块测试 | 3d | W7D1 | W7D3 | P0-4 |
| 6.2 WASM 模块测试 | 3d | W7D4 | W8D1 | P0-3 |
| 6.3 Agent 联邦测试 | 3d | W8D2 | W8D4 | P1-3 |
| 6.4 集成测试 | 3d | W8D5 | W9D2 | M3 |
| 6.5 E2E 测试 | 3d | W9D3 | W9D5 | 6.4 |

### P1-7: DAG Skill 执行 (开发 B, 3天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 7.1 DAG 加载解析 | 1d | W8D3 | W8D3 | M3 |
| 7.2 递归执行逻辑 | 1d | W8D4 | W8D4 | 7.1 |
| 7.3 结果合并 | 1d | W8D5 | W8D5 | 7.2 |

### P1-8: 安全加固实施 (开发 B, 8天)

| 子任务 | 工期 | 开始 | 结束 | 依赖 |
|--------|------|------|------|------|
| 8.1 输入验证集成 | 2d | W9D1 | W9D2 | P1-4, P1-6 |
| 8.2 命令白名单集成 | 2d | W9D3 | W9D4 | P1-5 |
| 8.3 审计日志 | 2d | W9D5 | W10D1 | 8.2 |
| 8.4 安全配置检查 | 2d | W10D2 | W10D3 | 8.3 |

---

## 时间线总览

```
Week 1 (架构基础)
├─ 开发 A: 配置抽象 (5d)
├─ 开发 B: 待命 (支持)
└─ 测试: 测试框架 (5d) + 安全基线 (5d)

Week 2-3 (架构重构)
├─ 开发 A: 全局状态消除 (7d)
└─ 开发 A: 事件总线 (8d)

Week 4 (架构收尾)
├─ 开发 A: 架构验收
└─ 里程碑 M1: 基础就绪

Week 5-6 (核心功能)
├─ 开发 A: WASM 执行 (10d)
├─ 开发 B: P2P 加密 (5d)
├─ 开发 B: P2P 连接 (3d - P1)
├─ 测试: WASM 沙箱审计 (3d)
└─ 里程碑 M2: WASM 可用

Week 7-8 (联邦 + 完善)
├─ 开发 A: Agent 联邦 (7d = 3d + 4d)
├─ 开发 B: 安全加固 (4d)
├─ 开发 B: DAG Skill (3d - P1)
├─ 测试: 测试用例 (6d)
└─ 里程碑 M3: 核心功能

Week 9-10 (测试)
├─ 测试: 测试用例 (9d 继续)
├─ 开发 A: 待命 (bugfix)
└─ 开发 B: 安全加固 (4d 继续)

Week 11-12 (优化 + 发布)
├─ 性能优化
├─ 安全加固收尾
├─ 回归测试
└─ 发布准备
```

---

## 依赖关系图

```
P0-1 架构重构 ─────────────────────────────────────────┐
    │                                                  │
    ├─▶ P0-3 WASM ──▶ P1-6 测试                        │
    │                                                  │
    └─▶ P0-4 P2P 加密 ──▶ P1-1 连接循环                │
                           │                           │
                           ▼                           │
                      P1-6 测试 ◀─────────────────────┘

P0-2 安全基线 ──▶ P1-8 安全加固

P0-6 测试框架 ──▶ 所有测试任务

M1 (W4) ──▶ M2 (W6) ──▶ M3 (W8) ──▶ 发布 (W12)
```

---

## 关键路径

```
P0-1 架构重构 (20d)
    │
    ▼
P0-3 WASM (10d) ─────────────┐
    │                        │
    ▼                        │
P1-2 联邦事件 (3d) ──▶ P1-3 远程任务 (4d)
                               │
                               ▼
                          测试 (2d)
                               │
                               ▼
                          发布准备 (2d)
```

**关键路径总长**: 41 天

---

## 风险应对

| 风险 | 触发条件 | 应对措施 | 负责人 |
|------|---------|---------|--------|
| WASM 延期 | W6 完成 < 50% | 降级到 Native Skill | 开发 A |
| P2P 加密问题 | Wireshark 显示明文 | 启用 TLS 1.3 备选 | 开发 B |
| 人力不足 | 关键人员缺席 > 3天 | 重新分配任务或延期 | PM |
| 测试不足 | W10 覆盖率 < 60% | 延期 1 周或降低目标 | 测试 |

---

## 每日站会模板

```
昨日完成:
- 任务 X: 完成度 Y%

今日计划:
- 任务 Z: 目标完成

阻塞:
- 需要 XXX 协助
```

---

## 周会检查清单

- [ ] 本周任务完成率
- [ ] 里程碑达成情况
- [ ] 新发现问题
- [ ] 下周计划调整
- [ ] 风险评估更新

---

*创建日期: 2026-02-10*  
*更新日期: 2026-02-10*  
*状态: 待团队确认*
